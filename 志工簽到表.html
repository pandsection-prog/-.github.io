<!DOCTYPE html>
<html>
<head>
    <title>志工簽到系統</title>
    <script src="cdnjs.cloudflare.com"></script>
</head>
<body>
    <form id="signForm">
        姓名：<input type="text" id="name" required onblur="autoFill()"><br>
        身份證字號：<input type="text" id="idNumber" required><br>
        狀態：<input type="radio" name="type" value="簽到" checked>簽到 
             <input type="radio" name="type" value="簽退">簽退<br>
        事由：<select id="reason"><option>1.參訪</option><option>2.授課講師</option></select><br>
        <button type="submit">提交</button>
        <button type="button" onclick="exportExcel()">匯出所有紀錄</button>
    </form>

    <script>
        const GAS_URL = 'https://docs.google.com/spreadsheets/d/159n7uGoZi4fjLfS3EsjxElVXE_xQ5UlPf6ZWNt1eIJ0/edit?gid=0#gid=0'; // 貼上你的部署網址

        // 自動填入：從瀏覽器快取讀取上次輸入的身分證
        function autoFill() {
            const savedData = localStorage.getItem(document.getElementById('name').value);
            if (savedData) document.getElementById('idNumber').value = savedData;
        }

        document.getElementById('signForm').onsubmit = async (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('name').value,
                idNumber: document.getElementById('idNumber').value,
                type: document.querySelector('input[name="type"]:checked').value,
                reason: document.getElementById('reason').value
            };
            localStorage.setItem(data.name, data.idNumber); // 儲存至本地供下次使用
            await fetch(GAS_URL, { method: 'POST', body: JSON.stringify(data) });
            alert('提交成功');
        };

        // 將網頁當前數據或模擬數據導出為 Excel
        function exportExcel() {
            const ws = XLSX.utils.json_to_sheet([{姓名: "範例", 身份證: "A123", 狀態: "簽到", 事由: "參訪"}]);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Records");
            XLSX.writeFile(wb, "志工簽到表.xlsx");
        }
    </script>
</body>
</html>




