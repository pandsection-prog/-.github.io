<form id="volunteerForm">
  <input type="text" id="name" placeholder="姓名" required onchange="saveInfo()">
  <input type="text" id="idNum" placeholder="身分證字號" required onchange="saveInfo()">
  
  <input type="radio" name="type" value="簽到" checked> 簽到
  <input type="radio" name="type" value="簽退"> 簽退
  
  <select id="reason">
    <option value="參訪">參訪</option>
    <option value="授課講師">授課講師</option>
  </select>
  
  <button type="button" onclick="submitData()">提交並下載 EXCEL</button>
</form>

<script src="cdnjs.cloudflare.com"></script>
<script>
// 自動載入上次輸入的資料
window.onload = () => {
  document.getElementById('name').value = localStorage.getItem('v_name') || '';
  document.getElementById('idNum').value = localStorage.getItem('v_id') || '';
};

function saveInfo() {
  localStorage.setItem('v_name', document.getElementById('name').value);
  localStorage.setItem('v_id', document.getElementById('idNum').value);
}

function submitData() {
  const data = [[
    new Date().toLocaleString(),
    document.getElementById('name').value,
    document.querySelector('input[name="type"]:checked').value,
    document.getElementById('idNum').value,
    document.getElementById('reason').value
  ]];

  // 匯出至 Excel 檔案
  const ws = XLSX.utils.aoa_to_sheet([["時間", "姓名", "狀態", "身分證", "事由"], ...data]);
  const wb = XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb, ws, "簽到紀錄");
  XLSX.writeFile(wb, "志工簽到表.xlsx");

  // 串接免費資料庫建議使用 [Google Apps Script](script.google.com) 
  // 將資料非同步傳送至 Google Sheet 以供管理員查閱
}
</script>
